mean_metals <- mean(return_metals,na.rm = TRUE)
for (i in 2:length(kapoor$TATASTEEL)) {
return_metals <-c(return_metals,(kapoor$TATASTEEL[i]/kapoor$TATASTEEL[i-1])-1)
}
mean_metals <- mean(return_metals,na.rm = TRUE)
sd_metals <- sd(return_metals)
source('C:/Users/conde_000/OneDrive - IESE Business School - University of Navarra/MiM/Business analytics R/Kappor/Kapoor preparation.R', echo=TRUE)
mean_CNX
sd_CNX
daily_return$CNX <- data.frame(return_CNX)
daily_return$CNX <- data.frame(CNXreturn_CNX)
daily_return <- data.frame(CNX=return_CNX)
view(daily_return)
daily_return$auto <- data.frame(return_auto)
daily_return <- data.frame(CNX=return_CNX)
daily_return$auto <- data.frame(return_auto)
daily_return$bank <- data.frame(return_bank)
daily_return$capsgoods <- data.frame(return_capgoods)
daily_return$consumer <- data.frame(return_consumer)
daily_return$fast <- data.frame(return_fast)
daily_return$health <- data.frame(return_health)
daily_return$info <- data.frame(return_info)
daily_return$metals <- data.frame(return_metals)
daily_return$oil <- data.frame(return_oil)
daily_return$power <- data.frame(return_power)
daily_return$teleco <- data.frame(return_teleco)
view(return_consumer)
source('C:/Users/conde_000/OneDrive - IESE Business School - University of Navarra/MiM/Business analytics R/Kappor/Kapoor preparation.R', echo=TRUE)
for (i in 2:length(consumer)) {
return_consumer <-c(return_capgoods,(consumer[i]/consumer[i-1])-1)
}
return_consumer
view(return_consumer)
for (i in 2:length(consumer)) {
i
return_consumer <-c(return_capgoods,(consumer[i]/consumer[i-1])-1)
}
for (i in 2:length(consumer)) {
print(i)
return_consumer <-c(return_capgoods,(consumer[i]/consumer[i-1])-1)
}
dummie <- c(i)
for (i in 2:length(consumer)) {
dummie <- c(i)
return_consumer <-c(return_capgoods,(consumer[i]/consumer[i-1])-1)
}
view(dummie)
for (i in 2:length(consumer)) {
dummie <- c(i)
return_consumer <-c(return_capgoods,(consumer[i]/consumer[i-1])-1)
}
view(dummie)
for (i in 2:length(consumer)) {
dummie <- c(dummie,i)
return_consumer <-c(return_capgoods,(consumer[i]/consumer[i-1])-1)
}
view(dummie)
for (i in 2:length(fast)) {
dummie <- c(dummie,i)
return_fast <-c(return_fast,(fast[i]/fast[i-1])-1)
}
view(dummie)
return_auto <-c()
return_bank <- c()
return_capgoods <- c()
return_consumer <- c()
return_fast <- c()
return_health <-c()
return_info <- c()
return_metals <- c()
return_oil <- c()
return_power <- c()
return_teleco <- c()
return_CNX <- c()
kapoor <- read_excel("kapoor.xlsx")
auto <- kapoor$TATAAUTO
bank <- kapoor$HDFC
capgoods <- kapoor$LARSEN
consumer <- kapoor$TKK
fast <- kapoor$DABUR
#11 sector return
for (i in 2:length(kapoor$CNX)) {
return_CNX <-c(return_CNX,(kapoor$CNX[i]/kapoor$CNX[i-1])-1)
}
mean_CNX <- mean(return_CNX)
sd_CNX <- sd(return_CNX)
for (i in 2:length(auto)) {
return_auto <-c(return_auto,(auto[i]/auto[i-1])-1)
}
mean_auto <- mean(return_auto)
sd_auto <- sd(return_auto)
for (i in 2:length(bank)) {
return_bank <-c(return_bank,(bank[i]/bank[i-1])-1)
}
mean_bank <- mean(return_bank)
sd_bank <- sd(return_bank)
for (i in 2:length(capgoods)) {
return_capgoods <-c(return_capgoods,(capgoods[i]/capgoods[i-1])-1)
}
mean_capgoods <- mean(return_capgoods)
sd_capgoods <- sd (return_capgoods)
for (i in 2:length(consumer)) {
return_consumer <-c(return_capgoods,(consumer[i]/consumer[i-1])-1)
}
mean_consumer <- mean(return_consumer)
sd_consumer <- sd(return_consumer)
for (i in 2:length(fast)) {
return_fast <-c(return_fast,(fast[i]/fast[i-1])-1)
}
mean_fast <- mean(return_fast)
sd_fast <- sd(return_fast)
for (i in 2:length(kapoor$SUN)) {
return_health <-c(return_health,(kapoor$SUN[i]/kapoor$SUN[i-1])-1)
}
mean_health <- mean(return_health)
sd_health <- sd (return_health)
for (i in 2:length(kapoor$WIPRO)) {
return_info <-c(return_info,(kapoor$WIPRO[i]/kapoor$WIPRO[i-1])-1)
}
mean_info <- mean(return_info)
sd_info <- sd(return_info)
for (i in 2:length(kapoor$TATASTEEL)) {
return_metals <-c(return_metals,(kapoor$TATASTEEL[i]/kapoor$TATASTEEL[i-1])-1)
}
mean_metals <- mean(return_metals,na.rm = TRUE)
sd_metals <- sd(return_metals)
for (i in 2:length(kapoor$INDIAN)) {
return_oil <-c(return_oil,(kapoor$INDIAN[i]/kapoor$INDIAN[i-1])-1)
}
mean_oil <- mean(return_oil)
sd_oil <- sd(return_oil)
for (i in 2:length(kapoor$NTPC)) {
return_power <-c(return_power,(kapoor$NTPC[i]/kapoor$NTPC[i-1])-1)
}
mean_power <- mean(return_power)
sd_power <- sd(return_power)
for (i in 2:length(kapoor$BHARTI)) {
return_teleco <-c(return_teleco,(kapoor$BHARTI[i]/kapoor$BHARTI[i-1])-1)
}
mean_teleco <- mean(return_teleco)
sd_teleco <- sd(return_teleco)
for (i in 2:length(consumer)) {
return_consumer <-c(return_consumer,(consumer[i]/consumer[i-1])-1)
}
source('C:/Users/conde_000/OneDrive - IESE Business School - University of Navarra/MiM/Business analytics R/Kappor/Kapoor preparation.R', echo=TRUE)
view(daily_return)
view(daily_return)
daily_return$auto <- data.frame(auto=return_auto)
daily_return$bank <- data.frame(bank=return_bank)
daily_return$capsgoods <- data.frame(capsgood=return_capgoods)
daily_return$consumer <- data.frame(consumer=return_consumer)
daily_return$fast <- data.frame(fast=return_fast)
daily_return$health <- data.frame(health=return_health)
daily_return$info <- data.frame(info=return_info)
daily_return$metals <- data.frame(metals=return_metals)
daily_return$oil <- data.frame(oil=return_oil)
daily_return$power <- data.frame(power=return_power)
daily_return$teleco <- data.frame(teleco=return_teleco)
view(daily_return)
view(daily_return)
mod_auto <- lm(CNX~auto.auto,data=daily_return)
summary(mod_auto)
mod_auto <- lm(CNX~auto.auto,data=daily_return)
mod_auto <- lm(CNX~auto,data=daily_return)
mod_auto <- lm(CNX~auto.auto,data=daily_return)
daily_return$auto
mod_auto <- lm(daily_return$CNX~daily_return$auto,data=daily_return)
summary(mod_auto)
mod_auto <- lm(daily_return$CNX~daily_return$auto,data=daily_return)
mod_auto <- lm(CNX~auto,data=daily_return)
daily_return$auto2 <- data.frame(auto=return_auto)
mod_auto <- lm(CNX~auto2,data=daily_return)
view(daily_return)
daily_return$auto[1]
mod_auto <- lm(CNX~auto[1],data=daily_return)
daily_return$auto <- data.frame(return_auto)
mod_auto <- lm(CNX~auto,data=daily_return)
daily_return$auto[1]
daily_return <- rbind(daily_return,data.frame(return_auto))
data.frame(return_auto)
view(data.frame(return_auto))
data.frame(return_auto[1])
daily_return <- data.frame()
daily_return <- data.frame(CNX=return_CNX)
daily_return$auto <- data.frame(return_auto)
daily_return$bank <- data.frame(bank=return_bank)
daily_return$capsgoods <- data.frame(capsgood=return_capgoods)
daily_return$consumer <- data.frame(consumer=return_consumer)
daily_return$fast <- data.frame(fast=return_fast)
daily_return$health <- data.frame(health=return_health)
daily_return$info <- data.frame(info=return_info)
daily_return$metals <- data.frame(metals=return_metals)
daily_return$oil <- data.frame(oil=return_oil)
daily_return$power <- data.frame(power=return_power)
daily_return$teleco <- data.frame(teleco=return_teleco)
View(daily_return)
daily_return$auto
daily_return$auto[1]
daily_return$CNX[1]
daily_return$bank[1]
return_auto <-c()
return_bank <- c()
return_capgoods <- c()
return_consumer <- c()
return_fast <- c()
return_health <-c()
return_info <- c()
return_metals <- c()
return_oil <- c()
return_power <- c()
return_teleco <- c()
return_CNX <- c()
kapoor <- read_excel("kapoor.xlsx")
auto <- kapoor$TATAAUTO
bank <- kapoor$HDFC
capgoods <- kapoor$LARSEN
consumer <- kapoor$TKK
fast <- kapoor$DABUR
#11 sector return
for (i in 2:length(kapoor$CNX)) {
return_CNX <-c(return_CNX,(kapoor$CNX[i]/kapoor$CNX[i-1])-1)
}
mean_CNX <- mean(return_CNX)
sd_CNX <- sd(return_CNX)
for (i in 2:length(auto)) {
return_auto <-c(return_auto,(auto[i]/auto[i-1])-1)
}
mean_auto <- mean(return_auto)
sd_auto <- sd(return_auto)
for (i in 2:length(bank)) {
return_bank <-c(return_bank,(bank[i]/bank[i-1])-1)
}
mean_bank <- mean(return_bank)
sd_bank <- sd(return_bank)
for (i in 2:length(capgoods)) {
return_capgoods <-c(return_capgoods,(capgoods[i]/capgoods[i-1])-1)
}
mean_capgoods <- mean(return_capgoods)
sd_capgoods <- sd (return_capgoods)
for (i in 2:length(consumer)) {
return_consumer <-c(return_consumer,(consumer[i]/consumer[i-1])-1)
}
mean_consumer <- mean(return_consumer)
sd_consumer <- sd(return_consumer)
for (i in 2:length(fast)) {
return_fast <-c(return_fast,(fast[i]/fast[i-1])-1)
}
mean_fast <- mean(return_fast)
sd_fast <- sd(return_fast)
for (i in 2:length(kapoor$SUN)) {
return_health <-c(return_health,(kapoor$SUN[i]/kapoor$SUN[i-1])-1)
}
mean_health <- mean(return_health)
sd_health <- sd (return_health)
for (i in 2:length(kapoor$WIPRO)) {
return_info <-c(return_info,(kapoor$WIPRO[i]/kapoor$WIPRO[i-1])-1)
}
mean_info <- mean(return_info)
sd_info <- sd(return_info)
for (i in 2:length(kapoor$TATASTEEL)) {
return_metals <-c(return_metals,(kapoor$TATASTEEL[i]/kapoor$TATASTEEL[i-1])-1)
}
mean_metals <- mean(return_metals,na.rm = TRUE)
sd_metals <- sd(return_metals)
for (i in 2:length(kapoor$INDIAN)) {
return_oil <-c(return_oil,(kapoor$INDIAN[i]/kapoor$INDIAN[i-1])-1)
}
mean_oil <- mean(return_oil)
sd_oil <- sd(return_oil)
for (i in 2:length(kapoor$NTPC)) {
return_power <-c(return_power,(kapoor$NTPC[i]/kapoor$NTPC[i-1])-1)
}
mean_power <- mean(return_power)
sd_power <- sd(return_power)
for (i in 2:length(kapoor$BHARTI)) {
return_teleco <-c(return_teleco,(kapoor$BHARTI[i]/kapoor$BHARTI[i-1])-1)
}
mean_teleco <- mean(return_teleco)
sd_teleco <- sd(return_teleco)
daily_return <- data.frame()
daily_return <- data.frame(CNX=return_CNX)
daily_return$auto <- data.frame(return_auto)
daily_return$bank <- data.frame(bank=return_bank)
daily_return$capsgoods <- data.frame(capsgood=return_capgoods)
daily_return$consumer <- data.frame(consumer=return_consumer)
daily_return$fast <- data.frame(fast=return_fast)
daily_return$health <- data.frame(health=return_health)
daily_return$info <- data.frame(info=return_info)
daily_return$metals <- data.frame(metals=return_metals)
daily_return$oil <- data.frame(oil=return_oil)
daily_return$power <- data.frame(power=return_power)
daily_return$teleco <- data.frame(teleco=return_teleco)
mod_auto <- lm(CNX~auto,data=daily_return)
mod_auto <- lm(CNX~auto,data=daily_return)
daily_return <- data.frame(CNX=return_CNX)
daily_return$auto <- data.frame(return_auto)
daily_return$bank <- data.frame(bank=return_bank)
daily_return$capsgoods <- data.frame(capsgood=return_capgoods)
daily_return$consumer <- data.frame(consumer=return_consumer)
daily_return$fast <- data.frame(fast=return_fast)
daily_return$health <- data.frame(health=return_health)
daily_return$info <- data.frame(info=return_info)
daily_return$metals <- data.frame(metals=return_metals)
daily_return$oil <- data.frame(oil=return_oil)
daily_return$power <- data.frame(power=return_power)
daily_return$teleco <- data.frame(teleco=return_teleco)
mod_auto <- lm(CNX~auto,data=daily_return)
View(daily_return)
daily_return <- data.frame()
daily_return <- data.frame(CNX=return_CNX)
daily_return$auto <- data.frame(unlist(return_auto))
daily_return$bank <- data.frame(unlist(return_bank))
daily_return$capsgoods <- data.frame(unlist(return_capgoods))
daily_return$consumer <- data.frame(unlist(return_consumer))
daily_return$fast <- data.frame(unlist(return_fast))
daily_return$health <- data.frame(unlist(return_health))
daily_return$info <- data.frame(unlist(return_info))
daily_return$metals <- data.frame(unlist(return_metals))
daily_return$oil <- data.frame(unlist(return_oil))
daily_return$power <- data.frame(unlist(return_power))
daily_return$teleco <- data.frame(unlist(return_teleco))
mod_auto <- lm(CNX~auto,data=daily_return)
daily_return$auto <- data.frame(unlist(return_auto))
daily_return$auto[1]
str(data_frame_name$auto)
str(daily_return$auto)
return_auto <-unlist(return_auto)
return_auto
str(return_auto)
daily_return$auto <- data.frame(unlist(return_auto))
mod_auto <- lm(CNX~auto,data=daily_return)
daily_return <- data.frame()
daily_return <- data.frame(CNX=return_CNX,auto=return_auto,bank=return_bank,capsgoods=return_capgoods,
consumer=return_consumer,fast=return_fast,health=return_health,
info=return_info,metals=return_metals,oil=return_oil,
power=return_power,teleco=return_teleco)
mod_auto <- lm(CNX~auto,data=daily_return)
summary(mod_auto)
View(daily_return)
View(daily_return)
#Preparing learning data
kappor_model <- read_excel("kapoor_model.xlsx")
mod_auto <- lm(CNX~auto,data=daily_return)
summary(mod_auto)
mod_bank <- lm(CNX~bank,data=daily_return)
summary(mod_bank)
mod_capgoods <- lm(CNX~capsgood,data=daily_return)
summary(mod_capgoods)
mod_consumer <- lm(CNX~consumer,data=daily_return)
summary(mod_consumer)
mod_fast <- lm(CNX~fast,data=daily_return)
summary(mod_fast)
mod_health <- lm(CNX~health, data=daily_return)
summary(mod_health)
mod_info <- lm(CNX~info, data=daily_return)
summary(mod_info)
mod_metals <- lm(CNX~metals, data=daily_return)
summary(mod_metals)
mod_oil <- lm(CNX~oil, data=daily_return)
summary(mod_oil)
mod_power <- lm(CNX~power, data=daily_return)
summary(mod_power)
mod_teleco <- lm(CNX~teleco, data=daily_return)
summary(mod_teleco)
#1)Betas indicate how strong the correlation of the relation between 2 variables is
summary(mod_auto)
summary(mod_auto)
mod_auto <- lm(auto~CNX,data=daily_return)
summary(mod_auto)
mod_bank <- lm(bank~CNX,data=daily_return)
summary(mod_bank)
mod_capgoods <- lm(capsgood~CNX,data=daily_return)
summary(mod_capgoods)
mod_consumer <- lm(consumer~CNX,data=daily_return)
summary(mod_consumer)
mod_fast <- lm(fast~CNX,data=daily_return)
summary(mod_fast)
mod_health <- lm(health~CNX, data=daily_return)
summary(mod_health)
mod_info <- lm(info~CNX, data=daily_return)
summary(mod_info)
mod_metals <- lm(metals~CNX, data=daily_return)
summary(mod_metals)
mod_oil <- lm(oil~CNX, data=daily_return)
summary(mod_oil)
mod_power <- lm(power~CNX, data=daily_return)
summary(mod_power)
mod_teleco <- lm(teleco~CNX, data=daily_return)
summary(mod_teleco)
View(daily_return)
sd(return_auto)
sd(return_larse)
sd(return_bank)
kable (daily_return %>%
summarize.if(is.numeric,funs(mean,sd,max,median,min),na.rm= TRUE) %>%
gather(stat,val) %>%
separate(stat,into=c("var","stat"),sep="_") %>%
spread(stat,val) %>%
select(var,mean,sd,min,median,max), bookstabs=TRUE,digits=2)
library(knitr)
library(readxl)
library(ggplot2)
library(tidyverse)
library(knitr)
kable (daily_return %>%
summarize.if(is.numeric,funs(mean,sd,max,median,min),na.rm= TRUE) %>%
gather(stat,val) %>%
separate(stat,into=c("var","stat"),sep="_") %>%
spread(stat,val) %>%
select(var,mean,sd,min,median,max), bookstabs=TRUE,digits=2)
kable (daily_return %>%
summarize_if(is.numeric,funs(mean,sd,max,median,min),na.rm= TRUE) %>%
gather(stat,val) %>%
separate(stat,into=c("var","stat"),sep="_") %>%
spread(stat,val) %>%
select(var,mean,sd,min,median,max), bookstabs=TRUE,digits=2)
sd(return_auto)
mean(return_auto)
kable (daily_return %>%
summarize_if(is.numeric,funs(mean,sd,max,median,min),na.rm= TRUE) %>%
gather(stat,val) %>%
separate(stat,into=c("var","stat"),sep="_") %>%
spread(stat,val) %>%
select(var,mean,sd,min,median,max), bookstabs=TRUE,digits=4)
View(kapoor)
View(return_auto)
predict(sample(CNX),mod_teleco)
predict(sample(daily_return$CNX),mod_teleco)
predict(sample(daily_return$CNX[1:2]),mod_teleco)
predict(sample(daily_return$CNX[1]),mod_teleco)
predict(mod_teleco,sample(daily_return$CNX[1]))
predict(mod_teleco,sample(daily_return$CNX))
predict(100,mod_teleco)
predict(c(100),mod_teleco)
predict(mod_teleco,data=daily_return)
daily_return$predict <- predict(mod_teleco,data=daily_return)
view(daily_return)
daily_return$predict_teleco <- predict(mod_teleco,data=daily_return)
rm(daily_return$predict)
daily_return <- data.frame()
daily_return <- data.frame(CNX=return_CNX,auto=return_auto,bank=return_bank,capsgoods=return_capgoods,
consumer=return_consumer,fast=return_fast,health=return_health,
info=return_info,metals=return_metals,oil=return_oil,
power=return_power,teleco=return_teleco)
daily_return$predict_teleco <- predict(mod_teleco,data=daily_return)
daily_return$error_predict <- daily_return$teleco - daily_return$predict_teleco
daily_return$error_predict <- (daily_return$teleco - daily_return$predict_teleco)/daily_return$teleco
sd(daily_return$error_predict)
sd(daily_return$error_predict,na.rm = T)
sd(daily_return$error_predict,na.rm = TRUE)
mean(daily_return$error_predict,na.rm = TRUE)
mean(daily_return$error_predict[1],na.rm = TRUE)
sd(daily_return$error_predict,inf.rm = TRUE)
daily_return_complete <- daily_return %>% dplyr::filter(complete.cases(.))
sd(daily_return_complete)
sd(daily_return_complete$error_predict)
daily_return$error_predict <- (daily_return$teleco - daily_return$predict_teleco)
mean(daily_return$error_predict)
sd(daily_return$error_predict)
daily_return <- data.frame()
daily_return <- data.frame(CNX=return_CNX,auto=return_auto,bank=return_bank,capsgoods=return_capgoods,
consumer=return_consumer,fast=return_fast,health=return_health,
info=return_info,metals=return_metals,oil=return_oil,
power=return_power,teleco=return_teleco)
daily_return$predict_teleco <- predict(mod_teleco,data=daily_return)
daily_return$error_predict_teleco <- (daily_return$teleco - daily_return$predict_teleco)
view(daily_return)
kapoor$cnx <- (kapoor$CNX-lag(kapoor$CNX)*100/lag(kapoor$CNX))
view(kapoor)
kapoor <- kapoor[-1,]
view(kapoor)
kapoor$LARSEN <- (kapoor$LARSEN-lag(kapoor$CNX)*100)/lag(kapoor$LARSEN)
kapoor <- kapoor[-1,]
kapoor
view(kapoor)
kapoor <- read_excel("kapoor.xlsx")
kapoor$cnx <- (kapoor$CNX-lag(kapoor$CNX)*100/lag(kapoor$CNX))
kapoor$larsen <- (kapoor$LARSEN-lag(kapoor$CNX)*100)/lag(kapoor$LARSEN)
kapoor <- kapoor[-1,]
view(kapoor)
cor(d$cnx,d$larsen)
cor(kapoor$cnx,kapoor$larsen)
camp <- (larsen~cnx,data=kapoor)
camp <- lm(larsen~cnx,data=kapoor)
kapoor$predict_larsen <- predict(camp)
kapoor$resid_larsen <- kapoor$larsen-kapoor$predict_larsen
view(kapoor)
#K
cor(kapoor$predict_larsen,kapoor$larsen)^2
#K
cor(kapoor$larsen,kapoor$predict_larsen)^2
var(kapoor$predict_larsen)/var(kapoor$larsen)
ggplot(kapoor,aes(cnx,larsen)) + geom_point() +
geom_smooth(method="lm", se=FALSE, size=0.5,alpha=0.6)
kapoor$cnx <- (kapoor$CNX-lag(kapoor$CNX)/lag(kapoor$CNX))
kapoor$larsen <- (kapoor$LARSEN-lag(kapoor$CNX))/lag(kapoor$LARSEN)
ggplot(kapoor,aes(cnx,larsen)) + geom_point() +
geom_smooth(method="lm", se=FALSE, size=0.5,alpha=0.6)
kapoor$larsen <- (kapoor$LARSEN-lag(kapoor$CNX))*100/lag(kapoor$LARSEN)
kapoor$cnx <- (kapoor$CNX-lag(kapoor$CNX)*100/lag(kapoor$CNX))
kapoor$larsen <- (kapoor$LARSEN-lag(kapoor$CNX))*100/lag(kapoor$LARSEN)
kapoor <- kapoor[-1,]
cor(kapoor$cnx,kapoor$larsen)
camp <- lm(larsen~cnx,data=kapoor)
kapoor$predict_larsen <- predict(camp)
kapoor$resid_larsen <- kapoor$larsen-kapoor$predict_larsen
#K
cor(kapoor$larsen,kapoor$predict_larsen)^2
var(kapoor$predict_larsen)/var(kapoor$larsen)
ggplot(kapoor,aes(cnx,larsen)) + geom_point() +
geom_smooth(method="lm", se=FALSE, size=0.5,alpha=0.6)
summary(camp)
