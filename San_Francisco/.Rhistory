d$predict <- predict(mod_price_fit,d)
library(tidyverse)
library(readxl)
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=d)
d <- read_excel("San Francisco.xlsx")
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=d)
summary(mod_price_fit)
d$predict <- predict(mod_price_fit,d)
View(d)
library(tidyverse)
library(readxl)
d <- read_excel("Learning_data.xlsx")
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=d)
testing <- read_excel("Testing data.xlsx")
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=learning)
learning <- read_excel("Learning_data.xlsx")
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=learning)
testing$predict <- predict(mod_price_fit,data=testing)
testing$predict <- predict(mod_price_fit,data=testing)
testing <- read_excel("Testing data.xlsx")
testing$predict <- predict(mod_price_fit,data=testing)
testing$predict <- predict(mod_price_fit,data=learning)
predict <- predict(mod_price_fit,data=testing)
View(predict)
predict <- data.frame(prediction=predict(mod_price_fit,data=testing))
View(predict)
testing <- read_excel("Testing data.xlsx")
library(readxl)
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=learning)
View(testing)
predict$price <- testing$Price
testing <- read_excel("Testing data.xlsx")
predict$price <- testing$Price
predict <- data.frame(prediction=predict(mod_price_fit,data=testing),price=testing$Price)
predict <- data.frame(prediction=predict(mod_price_fit,data=testing),
price=data.frame(c(testing$Price)))
predict <- data.frame(prediction=predict(mod_price_fit,data=testing))
View(predict)
write("prediction.xlsx",predict)
write(predict,file="predict.xlsx")
predict
predict <- data.frame(prediction=predict(mod_price_fit,data=testing))
predict
predict <-predict((mod_price_fit,data=testing))
library(tidyverse)
library(readxl)
predict <-predict(mod_price_fit,data=testing)
View(predict)
library(tidyverse)
library(readxl)
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
View(d)
View(testing)
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=learning)
predict <-predict(mod_price_fit,testing)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
predict <-predict(mod_price_fit,testing)
predict <-predict(mod_price_fit,learning)
mod_price_fit <- lm(Price~Dayslisted+Bedrooms+as.factor(Loft)+
Squarefeet+as.factor(Year)+as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
View(testing)
mod_price_fit <- lm(Price~Dayslisted+Bedrooms+as.factor(Loft)+
Squarefeet+as.factor(Year)+as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(Dayslisted)+as.factor(bedrooms),data=learning)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(Dayslisted)+as.factor(Bedrooms),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(Dayslisted)+Bedrooms,data=learning)
predict <-predict(mod_price_fit,testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+Dayslisted+Bedrooms,data=learning)
predict <-predict(mod_price_fit,testing)
View(predict)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+Dayslisted+Bedrooms+as.factor(Loft),data=learning)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(Dayslisted)+Bedrooms+as.factor(Loft),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(Year)+Dayslisted+Bedrooms+as.factor(Loft),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+Year+Dayslisted+Bedrooms+as.factor(Loft)+
Lotsize + Squarefeet,data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,testing)
testing$predict <- predict
View(testing)
sd(predict)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+Year+Dayslisted+Bedrooms+as.factor(Loft)+
Lotsize+ZipCode Squarefeet,data=learning)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=learning)
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,data=testing)
predict
predict <- data.frame(predict)
write(predict,file="predict.xlsx")
predict <- data.frame(predict=predict)
write(predict,file="predict.xlsx")
predict <- data.frame(predict=unlisted(predict))
predict <- data.frame(predict=unlist(predict))
write(predict,file="predict.xlsx")
View(learning)
predict[1]
predict <-predict(mod_price_fit,data=testing)
predict <- unlist(predict)
prediction <- data.frame(predict)
write(prediction,file="predict.xlsx")
prediction <- data.frame(predict=predict)
write(prediction,file="predict.xlsx")
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(ZipCode),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,data=testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(ZipCode),data=learning)
library(tidyverse)
library(readxl)
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
mod_price_fit <- lm(Price~as.factor(Neighborhood)+as.factor(ZipCode),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,data=testing)
predict <-predict(mod_price_fit,data=testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
predict <-predict(mod_price_fit,data=testing)
library(tidyverse)
library(readxl)
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
View(d)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,data=testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
rm(list = ls())
library(tidyverse)
library(readxl)
learning <- read_excel("Learning_data.xlsx")
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
predict <-predict(mod_price_fit,data=testing)
View(testing)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=testing)
summary(mod_price_fit)
predict <-predict(mod_price_fit,data=testing)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=learning)
mod_price_fit <- lm(Price~as.factor(Neighborhood),data=testing)
summary(mod_price_fit)
learning <- read_excel("Learning_data.xlsx")
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
mod_price_fit <- lm(Price~as.factor(loft),data=learning)
mod_price_fit <- lm(Price~as.factor(Loft),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,data=testing)
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Year)+as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
as.factor(Squarefeet)+as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Dayslisted)+as.factor(Bedrooms)+as.factor(Loft)+
Squarefeet+as.factor(Neighborhood),data=learning)
summary(mod_price_fit)
mod_price_fit <- lm(Price~as.factor(Squarefeet),data=learning)
summary(mod_price_fit)
predict <-predict(mod_price_fit,data=testing)
View(predict)
rm(list = ls())
San francisco <- read_excel("San_francisco.xlsx")
library(tidyverse)
library(readxl)
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
San francisco <- read_excel("San_francisco.xlsx")
San_francisco <- read_excel("San_francisco.xlsx")
San_francisco <- read_excel("San_francisco.xlsx")
mod_price <- lm(Price~as.factor(Address)+as.factor(ZipCode)+as.factor(DateListed)+
as.factor(Dayslisted)+Bedrooms+as.factor(Loft)+
Squarefeet+Lotsize+as.factor(Year)+as.factor(Neighborhood),data=d)
mod_price <- lm(Price~as.factor(Address)+as.factor(ZipCode)+as.factor(DateListed)+
as.factor(Dayslisted)+Bedrooms+as.factor(Loft)+
Squarefeet+Lotsize+as.factor(Year)+as.factor(Neighborhood),data=San_francisco)
summary(mod_price)
pred <- predict(mod_price,San_francisco)
San_francisco$predict <- predict(mod_price,San_francisco)
View(San_francisco)
mod_price <- lm(Price~as.factor(Squarefeet)+Lotsize+as.factor(Neighborhood),data=San_francisco)
summary(mod_price)
San_francisco$predict <- predict(mod_price,San_francisco)
test <- data.frame(Squarefeet=2249,Lotsize=2333,Neighborhood='High')
predict(mod_price,test)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood),data=San_francisco)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms,data=San_francisco)
summary(mod_price)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms+
Dayslisted,data=San_francisco)
summary(mod_price)
San_francisco$predict <- predict(mod_price,San_francisco)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms+
Dayslisted+as.factor(ZipCode),data=San_francisco)
summary(mod_price)
San_francisco$predict <- predict(mod_price,San_francisco)
testing$pred <- predict(mod_price,testing)
view(testing)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms+
Dayslisted+as.factor(ZipCode),data=learning)
summary(mod_price)
testing$pred <- predict(mod_price,testing)
view(testing)
sd(testing$pred)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms+
Dayslisted+as.factor(ZipCode)+Year,data=learning)
summary(mod_price)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms+
Dayslisted+as.factor(ZipCode)+as.factor(Year),data=learning)
summary(mod_price)
San_francisco$predict <- predict(mod_price,San_francisco)
testing$pred <- predict(mod_price,testing)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms+
Dayslisted+as.factor(ZipCode)+Year,data=learning)
San_francisco$predict <- predict(mod_price,San_francisco)
testing$pred <- predict(mod_price,testing)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+Bedrooms+
Dayslisted+as.factor(ZipCode)+Year,data=learning)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+as.factor(Bedrooms)+
Dayslisted+as.factor(ZipCode)+Year,data=learning)
summary(mod_price)
San_francisco$predict <- predict(mod_price,San_francisco)
testing$pred <- predict(mod_price,testing)
View(testing)
summary(mod_price)
sd(testing$pred)
summary(mod_price)
testing$pred <- predict(mod_price,testing)
testing$err <- testing$price - testing$pred
testing$err <- testing$price-testing$pred
testing$err <- testing$Price-testing$pred
sd(err)
sd(testing$err)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood)+as.factor(Dayslisted)
as.factor(Bedrooms)+Dayslisted+as.factor(ZipCode)+Year,data=learning)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood) + as.factor(Dayslisted)
as.factor(Bedrooms)+Dayslisted+as.factor(ZipCode)+Year,data=learning)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood) +
as.factor(Dayslisted) + as.factor(Bedrooms)+Dayslisted+as.factor(ZipCode)+Year,data=learning)
summary(mod_price)
testing$err <- testing$Price-testing$pred
testing$pred <- predict(mod_price,testing)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood) +
as.factor(Bedrooms)+Dayslisted+as.factor(ZipCode)+Year,data=learning)
summary(mod_price)
testing$pred <- predict(mod_price,testing)
testing$err <- testing$Price-testing$pred
learning <- read_excel("Learning_data.xlsx")
testing <- read_excel("Testing data.xlsx")
San_francisco <- read_excel("San_francisco.xlsx")
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood) +
as.factor(Bedrooms)+Dayslisted+as.factor(ZipCode)+Year,data=learning)
San_francisco$predict <- predict(mod_price,San_francisco)
testing$pred <- predict(mod_price,testing)
testing$err <- testing$Price-testing$pred
test <- data.frame(Squarefeet=2249,Lotsize=2333,Neighborhood='High')
View(testing)
View(cor(round(San_francisco),2))
View(San_francisco)
S_numeric <- select(San_francisco,ZipCode:year-DataListed)
library(tidyverse)
S_numeric <- select(San_francisco,ZipCode:year-DataListed)
S_numeric <- select(ZipCode:year-DataListed,San_francisco)
S_numeric <- dplyr::select(ZipCode:year-DataListed)
S_numeric <- dplyr::select(Dayslisted:year-DataListed)
S_numeric <-Dayslisted:year-DataListed
S_numeric <-select(Dayslisted:year-DataListed,San_francisco)
s <- select(Bedrooms:year,data=San_francisco)
s <- select('Bedrooms':year,data=San_francisco)
s <- select('Bedrooms':'year,data'=San_francisco)
s <- select('Bedrooms':'year,data',data=San_francisco)
s <- select(Bedrooms:year,data=San_francisco)
summary(mod_price)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood) +
as.factor(Bedrooms)+Dayslisted+Year,data=learning)
summary(mod_price)
mod_price <- lm(Price~Squarefeet+as.factor(Loft)+Lotsize+as.factor(Neighborhood) +
Bedrooms+Dayslisted+Year,data=learning)
summary(mod_price)
mod_price <- lm(Price~Squarefeet+Loft+Lotsize+as.factor(Neighborhood) +
Bedrooms+Dayslisted+Year,data=learning)
summary(mod_price)
mod_price <- lm(Price~Squarefeet+Lotsize+as.factor(Neighborhood) +
Bedrooms+Dayslisted+Year,data=learning)
summary(mod_price)
View(testing)
ggplot(testing,aes(pred,price)) + geom_point(alpha=0.6, size=0.3) +
geom_smooth(method="lm",color="brown",size=0.4,se=FALSE)
ggplot(testing,aes(pred,Price)) + geom_point(alpha=0.6, size=0.3) +
geom_smooth(method="lm",color="brown",size=0.4,se=FALSE)
min(testing$err)
View(San_francisco)
San_francisco$err <- San_francisco$Price - San_francisco$predict
sort(San_francisco$err)
sort(San_francisco$err[end-10:end])
sort(San_francisco$err)
View(sort(San_francisco$err))
View(San_francisco)
mod_price <- lm(Price~Squarefeet+Lotsize+as.factor(Neighborhood) +
Bedrooms+Dayslisted+Year,data=learning)
San_francisco$predict <- predict(mod_price,San_francisco)
San_francisco$err <- San_francisco$Price - San_francisco$predict
testing$pred <- predict(mod_price,testing)
testing$err <- testing$Price-testing$pred
ggplot(testing,aes(pred,Price)) + geom_point(alpha=0.6, size=0.3) +
geom_smooth(method="lm",color="brown",size=0.4,se=FALSE)
View(round(cor(d,c(5,6,7,8))),2)
View(round(cor(learning,c(5,6,7,8))),2)
View(round(cor(San_francisco,c(5,6,7,8))),2)
View(round(cor(San_francisco,c(5,6))),2)
View(round(cor(San_francisco,c(6,7))),2)
summary(mod_price)
residuals(mod_price)
View(residuals(mod_price))
View(sort(residuals(mod_price)))
View(-sort(residuals(mod_price)))
