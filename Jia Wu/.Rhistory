library(readxl)
library(tidyverse)
library(ggplot2)
d <- read_excel("Jia_wu.xlsx",sheet = "Data")
View(d)
View(d)
mean(d$Sales)
d.ts <- ts(d$Sales,frequency = 12)
head(d.ts,100)
plot(d.ts,xlab="Month",ylab="Sales",bty="l")
plot(d$Sales)
plot(d.ts,xlab="Month",ylab="Sales",bty="l")
plot(d$Sales)
plot(d.ts,xlab="Month",ylab="Sales",bty="l")
plot(d$Sales,bty="l")
plot(d$Sales,bty="l")
plot(d.ts,xlab="Month",ylab="Sales",bty="l")
ntrain <-180*0.8
ntest <-length(d.ts,start=c(1,1),end=c(1,ntrain))
ntest <- length(d.ts)-ntrain
train.ts <-window(d.ts,start=c(1,1),end=c(1,ntrain))
test.ts <-window(d.ts,start=c(1,ntrain+1),end=c(1,ntrain+ntest))
naive.pred <- naive(train.ts,h=ntest)
library(forecast)
naive.pred <- naive(train.ts,h=ntest)
snaive.pred <- snaive(train.ts,h=ntest)
x <- as.data.frame(snaive.pred)
View(x)
fit <- RMSE(test.ts,naive.pred$mean)
fit <- rmse(test.ts,naive.pred$mean)
library(Metrics)
fit <- rmse(test.ts,naive.pred$mean)
fit
cor(test.ts,snaive.pred$mean)^2
plot(dftest.ts,bty="l")
plot(test.ts,bty="l")
plot(test.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="red",lty=1)
lines(naive.pred$mean,lwd=1,col="blue",lty=1)
View(d)
#Trend+season
mod_l <- lm(Sales~Date,d)
summary(mod_l)
pred_l <- predict(mod_l,d)
#Trend+season
mod_l <- lm(Sales~Date,d.ts)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
mod_q <- lm(Sales~Date+I(Date)^2,d)
summary(mod_q)
pred_l <- predict(mod_q,d)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
#Tremd+seasonal
mod_add <- tslm(d.ts~trend+I(trend^2)+season)
summary(mod_add)
pred_add <- predict(mod_add,d)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
library(readxl)
library(tidyverse)
library(ggplot2)
library(forecast)
library(Metrics)
d <- read_excel("Jia_wu.xlsx",sheet = "Data")
d.ts <- ts(d$Sales,frequency = 12)
head(d.ts,100)
plot(d$Sales,bty="l")
plot(d.ts,xlab="Month",ylab="Sales",bty="l")
ntrain <-180*0.8
ntest <- length(d.ts)-ntrain
train.ts <-window(d.ts,start=c(1,1),end=c(1,ntrain))
test.ts <-window(d.ts,start=c(1,ntrain+1),end=c(1,ntrain+ntest))
naive.pred <- naive(train.ts,h=ntest)
snaive.pred <- snaive(train.ts,h=ntest)
x <- as.data.frame(snaive.pred)
fit <- rmse(test.ts,naive.pred$mean)
fit
cor(test.ts,snaive.pred$mean)^2
plot(test.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="red",lty=1)
lines(naive.pred$mean,lwd=1,col="blue",lty=1)
#Trend+season
mod_l <- lm(Sales~Date,d)
summary(mod_l)
pred_l <- predict(mod_l,d)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
mod_q <- lm(Sales~Date+I(Date)^2,d)
summary(mod_q)
pred_l <- predict(mod_q,d)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
#Tremd+seasonal
mod_add <- tslm(d.ts~trend+I(trend^2)+season)
pred_add <- predict(mod_add,d)
summary(mod_add)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
arima <- auto.arima(d.ts,seasonal = T)
library(readxl)
library(tidyverse)
library(ggplot2)
library(forecast)
library(Metrics)
arima <- auto.arima(d.ts,seasonal = T)
lines(arima$fitted,lwd=1,col="brown",lty=1)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
arima <- auto.arima(d.ts,seasonal = F)
arima <- auto.arima(d.ts,seasonal = T)
library(Metrics)
arima <- auto.arima(d.ts,seasonal =F)
library(tidyverse)
library(ggplot2)
library(forecast)
library(Metrics)
arima <- auto.arima(d.ts,seasonal =F)
lines(arima$fitted,lwd=1,col="brown",lty=1)
arima <- auto.arima(d.ts,seasonal =F)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
arima <- auto.arima(d.ts,seasonal =T)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
plot(d.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
cor(d.ts,arima)^2
cor(d.ts,arima$fitted)^2
arima <- auto.arima(train.ts,seasonal =T)
arima <- auto.arima(train.ts,seasonal =T)
pred_add <- forecast(arima,h=ntest)
pred_add <- forecast(arima,h=ntest)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
ntest
pred_add <- forecast(arima,h=36)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
pred_add <- forecast(arima,h=ntrain)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
pred_add <- forecast(arima,h)
pred_add <- forecast(arima)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
pred_add <- forecast(arima,h=144)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
plot(d.ts,bty="l")
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
library(readxl)
library(tidyverse)
library(ggplot2)
library(forecast)
library(Metrics)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
plot(d.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
cor(d.ts,arima$fitted)^2
#arima predict
train.ts <-window(d.ts,start=c(1,1),end=c(1,ntrain))
test.ts <-window(d.ts,start=c(1,ntrain+1),end=c(1,ntrain+ntest))
arima <- auto.arima(train.ts,seasonal =T)
pred_add <- forecast(arima,h=144)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
library(readxl)
library(tidyverse)
library(ggplot2)
library(forecast)
library(Metrics)
d <- read_excel("Jia_wu.xlsx",sheet = "Data")
d.ts <- ts(d$Sales,frequency = 12)
head(d.ts,100)
plot(d$Sales,bty="l")
plot(d.ts,xlab="Month",ylab="Sales",bty="l")
ntrain <-180*0.8
ntest <- length(d.ts)-ntrain
train.ts <-window(d.ts,start=c(1,1),end=c(1,ntrain))
test.ts <-window(d.ts,start=c(1,ntrain+1),end=c(1,ntrain+ntest))
naive.pred <- naive(train.ts,h=ntest)
snaive.pred <- snaive(train.ts,h=ntest)
x <- as.data.frame(snaive.pred)
fit <- rmse(test.ts,naive.pred$mean)
fit
cor(test.ts,snaive.pred$mean)^2
plot(test.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="red",lty=1)
lines(naive.pred$mean,lwd=1,col="blue",lty=1)
#Trend+season
mod_l <- lm(Sales~Date,d)
summary(mod_l)
pred_l <- predict(mod_l,d)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
mod_q <- lm(Sales~Date+I(Date)^2,d)
summary(mod_q)
pred_l <- predict(mod_q,d)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
#Tremd+seasonal
mod_add <- tslm(d.ts~trend+I(trend^2)+season)
pred_add <- predict(mod_add,d)
summary(mod_add)
arima <- auto.arima(d.ts,seasonal =T)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
plot(d.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
cor(d.ts,arima$fitted)^2
#arima predict
train.ts <-window(d.ts,start=c(1,1),end=c(1,ntrain))
test.ts <-window(d.ts,start=c(1,ntrain+1),end=c(1,ntrain+ntest))
arima <- auto.arima(train.ts,seasonal =T)
pred_add <- forecast(arima,h=144)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
plot(d.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
plot(d$Sales,bty="l")
#Trend+season
mod_l <- lm(Sales~Date,d)
summary(mod_l)
pred_l <- predict(mod_l,d)
plot(d$Sales,bty="l")
lines(pred_l,lwd=1,col="blue",lty=1)
d$pred <-pred_l
View(d)
d$error <- d$Date - d$pred
plot(d$error,bty="l")
plot(d$error)
d$error <- d$Sales - d$pred
plot(d$error)
summary(mod_add)
#Tremd+seasonal
mod_add <- tslm(d.ts~trend:season)
pred_add <- predict(mod_add,d)
summary(mod_add)
plot(d$Sales,bty="l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
sum(d$error)
summary(mod_add)
plot(d.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
ggplot(data=d,aes(error)) + geom_density()
install.packages("lubridate")
install.packages("lubridate")
d
plot(d$Sales,type="l")
plot(d$Sales,type = "l")
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
d.ts-pred_add
mean(d.ts-pred_add)
d$month <- month(d$Date)
library(lubridate)
d$month <- month(d$Date)
View(d)
plot(d.ts,bty="l")
lines(snaive.pred$mean,lwd=1,col="orange",lty=1)
lines(naive.pred$mean,lwd=1,col="dark green",lty=1)
lines(pred_add,lwd=1,col="blue",lty=1)
lines(pred_l,lwd=1,col="red",lty=1)
lines(arima$fitted,lwd=1,col="green",lty=1)
lines(arima$fitted,lwd=1,col="dark green",lty=1)
lines(arima$fitted,lwd=1,col="dark blue",lty=1)
lines(arima$fitted,lwd=1,col="brown",lty=1)
View(x)
plot(test.ts,bty="l")
lines(pred_add$x,col="brown",lty=1)
lines(pred_add$fitted,col="brown",lty=1)
#arima predict
train.ts <-window(d.ts,start=c(1,1),end=c(1,ntrain))
test.ts <-window(d.ts,start=c(1,ntrain+1),end=c(1,ntrain+ntest))
arima <- auto.arima(train.ts,seasonal =T)
pred_add <- forecast(arima,h=144)
library(forecast)
library(readxl)
library(tidyverse)
library(ggplot2)
library(forecast)
library(lubridate)
library(Metrics)
arima <- auto.arima(train.ts,seasonal =T)
pred_add <- forecast(arima,h=144)
plot(test.ts,bty="l")
lines(pred_add$fitted,col="brown",lty=1)
lines(pred_add$x,col="brown",lty=1)
lines(pred_add$x,col="brown",lty=1)
